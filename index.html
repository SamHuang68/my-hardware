<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>Hardware Asset Registry | Sam Huang</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background: #0a0a0a; color: #d1d5db; font-family: 'Consolas', monospace; }
        .data-table { width: 100%; border-collapse: collapse; margin-bottom: 2.5rem; background: #111; }
        .data-table th, .data-table td { border: 1px solid #333; padding: 14px; text-align: left; font-size: 0.85rem; vertical-align: top; }
        .data-table th { background: #1a1a1a; color: #3b82f6; text-transform: uppercase; }
        .tag-mop { background: #1e3a8a; color: #60a5fa; padding: 2px 5px; border-radius: 4px; font-weight: bold; font-size: 10px; }
        .section-title { font-size: 1.3rem; font-weight: bold; color: #fff; margin: 2rem 0 1rem 0; border-left: 5px solid #3b82f6; padding-left: 1.2rem; }
    </style>
</head>
<body class="p-8 lg:p-16">
    <header class="mb-12 border-b border-gray-800 pb-6 text-center lg:text-left">
        <h1 class="text-3xl font-black text-white uppercase italic tracking-tighter italic">Hardware <span class="text-blue-500 font-sans">Command Center</span></h1>
        <p id="meta-info" class="text-gray-500 text-sm mt-2 font-mono"></p>
    </header>
    <div id="registry-container"></div>
    <script>
        async function init() {
            try {
                const res = await fetch('data.json?cb=' + Date.now());
                if (!res.ok) throw new Error('Network Error: data.json missing');
                const data = await res.json();
                
                document.getElementById('meta-info').innerText = `LAST SYNC: ${data.last_updated} | OWNER: ${data.inventory_owner}`;
                const container = document.getElementById('registry-container');

                container.innerHTML += `<div class="section-title italic">I. COMPUTING ASSETS (UPGRADE TRACKER)</div>`;
                let table = `<table class="data-table"><thead><tr><th>System</th><th>CPU / Architecture</th><th>RAM (MoP)</th><th>Storage</th><th>GPU / PSU / Case</th><th>Lifecycle & Upgrade Notes</th></tr></thead><tbody>`;

                data.hardware_registry.forEach(h => {
                    const ramDisplay = h.ram.spec.includes('MoP') ? `<span class="tag-mop">MoP</span> ${h.ram.spec}` : h.ram.spec;
                    
                    // 修正 GPU 顯示邏輯，防止 undefined
                    let gpuText = `Primary: ${h.gpu.main}`;
                    if (h.gpu.sub && h.gpu.sub !== "N/A") gpuText += `<br>Sub: ${h.gpu.sub}`;
                    if (h.gpu.note) gpuText += `<br><span class="text-blue-400 text-[10px] underline">${h.gpu.note}</span>`;

                    table += `<tr>
                        <td class="font-bold text-white text-base">${h.name}</td>
                        <td>${h.cpu.model}<br><span class="text-gray-600 text-xs">${h.cpu.architecture}</span></td>
                        <td>${ramDisplay}</td>
                        <td>${h.storage.primary}</td>
                        <td>GPU: ${gpuText}<br>PSU: ${h.power_supply}${h.motherboard ? `<br>Mobo: ${h.motherboard}` : ""}${h.case ? `<br>Case: ${h.case}` : ""}</td>
                        <td class="text-orange-400 italic font-medium">${h.upgrade_notes}</td>
                    </tr>`;
                });
                table += `</tbody></table>`;
                container.innerHTML += table;

                container.innerHTML += `<div class="section-title italic">II. VISUAL ASSETS</div>`;
                let dTable = `<table class="data-table"><thead><tr><th>Model</th><th>Panel Technology</th><th>Detailed Specifications</th></tr></thead><tbody>`;
                data.display_assets.forEach(d => {
                    dTable += `<tr><td class="font-bold text-blue-400 text-base">${d.name}</td><td>${d.panel}</td><td>${d.specs}</td></tr>`;
                });
                dTable += `</tbody></table>`;
                container.innerHTML += dTable;
            } catch (e) {
                document.getElementById('registry-container').innerHTML = `
                <div class="bg-red-900/20 border border-red-500 p-8 rounded-xl text-red-400 font-bold">
                    [DATABASE ERROR]: ${e.message}<br>
                    <span class="text-xs font-normal text-gray-400 underline italic mt-2 block">Action Required: Verify JSON syntax and check GitHub Actions deployment status.</span>
                </div>`;
            }
        }
        init();
    </script>
</body>
</html>
